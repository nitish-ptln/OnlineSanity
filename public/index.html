<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telephony Manager Sanity Suite</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;600;700&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo-section">
                <div class="logo">
                    <div class="logo-icon">üì°</div>
                    <h1>Telephony<br>Manager</h1>
                </div>
                <p class="tagline">Sanity Testing Suite</p>
                <p class="creator">Created by: Nitish Kumar (nitish10.kumar)</p>
            </div>

            <nav class="model-nav">
                <div class="nav-label">SELECT MODELS</div>
                <ul class="model-list">
                    <!-- Dynamic Items -->
                </ul>
            </nav>

            <div class="sidebar-config">
                <div class="config-group">
                    <label>ADB COMMAND</label>
                    <div class="adb-toggle" style="display: flex; gap: 5px; margin-bottom: 10px;">
                        <button class="toggle-btn" data-adb="adb1"
                            style="flex:1; padding: 6px; font-size: 0.75rem;">ADB1</button>
                        <button class="toggle-btn" data-adb="adb"
                            style="flex:1; padding: 6px; font-size: 0.75rem;">ADB</button>
                    </div>
                </div>

                <div class="config-group">
                    <label>ADB TARGET DEVICE</label>
                    <select id="deviceSelector" class="form-control"
                        style="background: rgba(255,255,255,0.05); color: white; border: 1px solid var(--border-color); font-size: 0.8rem;">
                        <option value="" disabled selected>Select Device...</option>
                    </select>
                </div>

                <div class="connection-status" id="connectionStatus">
                    <span class="status-dot"></span>
                    <span class="status-text">Ready</span>
                </div>

                <div class="tools-section"
                    style="margin-top: 25px; border-top: 1px solid rgba(255,255,255,0.05); padding-top: 20px;">
                    <div id="btnDltSettings" class="btn-secondary"
                        style="display: block; padding: 15px; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; cursor: pointer; transition: all 0.2s ease; text-align: center;">
                        <img src="dlt_logo.png" alt="DLT Logo" style="width: 42px; height: 42px; margin-bottom: 10px;">
                        <div
                            style="font-size: 0.85rem; font-weight: 700; color: var(--text-primary); margin-bottom: 4px;">
                            DLT Settings</div>
                        <div
                            style="display: flex; align-items: center; justify-content: center; gap: 6px; color: #4CAF50; font-size: 0.65rem;">
                            <span
                                style="display: inline-block; width: 6px; height: 6px; background: #4CAF50; border-radius: 50%;"></span>
                            <span id="dltCurrentConfig">Bridge: 3490</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sidebar-footer">
                <button class="btn-primary w-100" id="btnManage">
                    <span>‚ûï</span> Manage Tests
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <div class="breadcrumb">
                    <button class="menu-toggle" id="sidebarToggle">‚ò∞</button>
                    <span class="bc-item">Dashboard</span>
                    <span class="bc-sep">/</span>
                    <span class="bc-item active" id="currentModel">Loading...</span>
                </div>
                <div class="top-actions">
                    <button class="btn-theme-toggle" id="btnThemeToggle" title="Toggle Theme">‚òÄÔ∏è</button>
                    <button class="btn-secondary" id="btnRefreshDevice">üîÑ Refresh Dev info</button>
                    <button class="btn-secondary" id="btnReboot">üîå Reboot</button>
                    <button class="btn-danger" id="btnClearResults">üóëÔ∏è Clear Results</button>
                    <button class="btn-success" id="btnExport">üì• Export Excel</button>
                    <button class="btn-primary" id="btnViewReport">üìã View Report</button>
                    <button class="btn-warning" id="btnRegression">‚öôÔ∏è Regression</button>
                    <button class="btn-primary" id="btnRunAll">‚ñ∂Ô∏è Run All Tests</button>
                    <div class="module-run-group"
                        style="display: flex; gap: 5px; align-items: center; margin-left: 10px; padding-left: 10px; border-left: 1px solid rgba(255,255,255,0.2);">
                        <select id="moduleSelector" class="form-control"
                            style="background: rgba(255,255,255,0.1); color: white; border: 1px solid var(--border-color); padding: 8px 12px; border-radius: 6px; font-size: 0.85rem; min-width: 130px;">
                            <option value="all">All Modules</option>
                            <option value="region">Region MGR</option>
                            <option value="sim">SIM</option>
                            <option value="network">Network</option>
                            <option value="call">Call</option>
                            <option value="sms">SMS</option>
                            <option value="ecall">eCall</option>
                            <option value="data">Data</option>
                        </select>
                        <button class="btn-accent" id="btnRunModule"
                            style="background: linear-gradient(135deg, #f59e0b, #d97706); padding: 8px 16px; white-space: nowrap;">üéØ
                            Run Module</button>
                    </div>
                </div>
            </header>

            <div class="content-wrapper">
                <!-- Device Info Cards -->
                <div class="device-grid">
                    <div class="device-status-card" id="deviceStatusCard">
                        <div class="device-icon">üì±</div>
                        <div class="device-details">
                            <span class="device-label">Device Status</span>
                            <span class="device-value" id="deviceStatusText">Checking...</span>
                        </div>
                    </div>
                    <div class="device-status-card">
                        <div class="device-icon">üÜî</div>
                        <div class="device-details">
                            <span class="device-label">IMEI</span>
                            <span class="device-value" id="deviceIdDisplay">-</span>
                        </div>
                    </div>
                    <div class="device-status-card" id="simStateCard">
                        <div class="device-icon">üí≥</div>
                        <div class="device-details">
                            <span class="device-label">SIM State</span>
                            <span class="device-value" id="simStatusDisplay">-</span>
                        </div>
                    </div>
                    <div class="device-status-card" id="serviceStateCard">
                        <div class="device-icon">üì∂</div>
                        <div class="device-details">
                            <span class="device-label">Service State</span>
                            <span class="device-value" id="serviceStateDisplay">-</span>
                        </div>
                    </div>
                    <div class="device-status-card" id="regionCard">
                        <div class="device-icon" id="regionIcon">üåç</div>
                        <div class="device-details">
                            <span class="device-label">Region</span>
                            <span class="device-value" id="regionDisplay">-</span>
                        </div>
                    </div>
                    <div class="device-status-card">
                        <div class="device-icon">‚ÑπÔ∏è</div>
                        <div class="device-details">
                            <span class="device-label">Software Ver</span>
                            <span class="device-value" id="swVersionDisplay">-</span>
                        </div>
                    </div>
                    <div class="device-status-card" id="radioStateCard">
                        <div class="device-icon">üìª</div>
                        <div class="device-details">
                            <span class="device-label">Radio State</span>
                            <span class="device-value" id="radioStatusDisplay">-</span>
                        </div>
                    </div>
                </div>

                <!-- Stats Bar -->
                <div class="stats-bar">
                    <div class="stat-card">
                        <span class="stat-value" id="totalTests">0</span>
                        <span class="stat-label">Total Tests</span>
                    </div>
                    <div class="stat-card stat-pass">
                        <span class="stat-value" id="passedTests">0</span>
                        <span class="stat-label">Passed</span>
                    </div>
                    <div class="stat-card stat-fail">
                        <span class="stat-value" id="failedTests">0</span>
                        <span class="stat-label">Failed</span>
                    </div>
                    <div class="stat-card stat-pending">
                        <span class="stat-value" id="pendingTests">0</span>
                        <span class="stat-label">Pending</span>
                    </div>
                </div>

                <!-- Dynamic Content Section -->
                <div class="commands-section">
                    <div class="section-header">
                        <h2>Sanity Commands</h2>
                        <div class="filter-tabs" id="filterTabs">
                            <!-- Dynamic tabs based on model -->
                        </div>
                    </div>

                    <!-- Network IMEI Module -->
                    <div class="custom-module network-module" id="imeiModule">
                        <div class="module-header">
                            <h3>üì∂ Network Configuration</h3>
                            <p class="module-desc">Manage IMEI and Preferred Network Type</p>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; align-items: start;">
                            <!-- IMEI Section -->
                            <div class="module-form" style="display: flex; flex-direction: column; gap: 10px;">
                                <div class="module-input-group">
                                    <label>üÜî Set IMEI</label>
                                    <input type="text" id="targetImei" value="351259160001217"
                                        placeholder="Enter 15-digit IMEI">
                                </div>
                                <button class="btn-module-action btn-dial" id="btnSetImei">Set IMEI</button>
                                <div class="module-result" id="imeiResult" style="margin-top: 5px;"></div>
                            </div>

                            <!-- Pref Net Type Section -->
                            <div class="module-form"
                                style="display: flex; flex-direction: column; gap: 10px; border-left: 1px solid var(--border-color); padding-left: 20px;">
                                <div class="module-input-group">
                                    <label>üì° Preferred Network Type</label>
                                    <select id="prefNetTypeSelect" class="form-control" style="font-size: 0.9rem;">
                                        <option value="0">0 - WCDMA preferred</option>
                                        <option value="1">1 - GSM only</option>
                                        <option value="2">2 - WCDMA only</option>
                                        <option value="3">3 - GSM & UMTS</option>
                                        <option value="4">4 - CDMA and EVDO</option>
                                        <option value="5">5 - CDMA</option>
                                        <option value="6">6 - EVDO & no CDMA</option>
                                        <option value="8">8 - LTE, CDMA & EVDO</option>
                                        <option value="9">9 - LTE, GSM & WCDMA</option>
                                        <option value="10">10 - LTE, CDMA, EVDO, GSM & WCDMA</option>
                                        <option value="11" selected>11 - LTE only</option>
                                        <option value="12">12 - LTE & WCDMA</option>
                                        <option value="13">13 - TD-SDCAM only</option>
                                        <option value="14">14 - TD-SDCAM & WCDMA</option>
                                        <option value="15">15 - TD-SDCAM & LTE</option>
                                        <option value="16">16 - TD-SDCAM & GSM</option>
                                        <option value="17">17 - TD-SDCAM, GSM & LTE</option>
                                        <option value="18">18 - TD-SDCAM, GSM, & WCDMA</option>
                                        <option value="19">19 - TD-SDCAM, WCDMA & LTE</option>
                                        <option value="20">20 - TD-SDCAM, GSM, WCDMA & LTE</option>
                                        <option value="23">23 - NR5G Mode Only</option>
                                        <option value="25">25 - GSM, WCDMA, LTE AND NR5G</option>
                                        <option value="26">26 - GSM, WCDMA and NR5G</option>
                                        <option value="27">27 - GSM, LTE and NR5G</option>
                                        <option value="28">28 - WCDMA, LTE, NR5G</option>
                                        <option value="29">29 - GSM and 5G</option>
                                        <option value="30">30 - WCDMA, 5G</option>
                                        <option value="31">31 - LTE and 5G</option>
                                        <option value="50">50 - LTE, GSM</option>
                                    </select>
                                </div>
                                <button class="btn-module-action btn-primary" id="btnSetNetType">Set Type</button>
                                <div class="module-result" id="netTypeResult" style="margin-top: 5px;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Custom SMS Module (Shared between models that have SMS) -->
                    <div class="custom-module sms-module" id="smsModule">
                        <div class="module-header"
                            style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div>
                                <h3>üí¨ SMS</h3>
                                <p class="module-desc">Send a custom SMS message to any phone number</p>
                            </div>
                            <button class="btn-icon-add" onclick="app.showManageModal('sms')" title="Add SMS Test"
                                style="display: none;">‚ûï</button>
                        </div>
                        <div class="module-form">
                            <div class="module-input-group">
                                <label>üì± Phone Number</label>
                                <input type="tel" id="smsPhoneNumber" value="7717487889"
                                    placeholder="Enter phone number">
                            </div>
                            <div class="module-input-group">
                                <label>‚úâÔ∏è Message</label>
                                <input type="text" id="smsMessage" value="hello" placeholder="Enter message">
                            </div>
                            <button class="btn-module-action btn-sms" id="btnSendSms">
                                <span>üì§</span> Send SMS
                            </button>
                        </div>
                        <div class="module-result" id="smsResult"></div>
                    </div>

                    <!-- Custom Call Module -->
                    <div class="custom-module call-module" id="callModule">
                        <div class="module-header"
                            style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div>
                                <h3>üìû Call</h3>
                                <p class="module-desc">Dial a custom phone number</p>
                            </div>
                            <button class="btn-icon-add" onclick="app.showManageModal('call')" title="Add Call Test"
                                style="display: none;">‚ûï</button>
                        </div>
                        <div class="module-form">
                            <div class="module-input-group">
                                <label>üì± Phone Number</label>
                                <input type="tel" id="dialPhoneNumber" value="7975602020"
                                    placeholder="Enter phone number to dial">
                            </div>
                            <button class="btn-module-action btn-dial" id="btnDial">
                                <span>üìû</span> Dial Number
                            </button>
                            <button class="btn-module-action btn-end-call" id="btnEndCall">
                                <span>üìµ</span> End Call
                            </button>
                        </div>
                        <div class="module-result" id="callResult"></div>
                    </div>

                    <!-- Region Module -->
                    <div class="custom-module region-module" id="regionModule">
                        <div class="module-header"
                            style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div>
                                <h3>üåç Region MGR</h3>
                                <p class="module-desc">Set custom Region Number for the device</p>
                            </div>
                            <button class="btn-icon-add" onclick="app.showManageModal('region')" title="Add Region Test"
                                style="display: none;">‚ûï</button>
                        </div>
                        <div class="module-form">
                            <div class="module-input-group">
                                <label>üî¢ Region Number</label>
                                <input type="number" id="regionNumber" value="4378"
                                    placeholder="Enter region number (e.g. 4378)">
                            </div>
                            <button class="btn-module-action btn-region" id="btnSetRegion">
                                <span>üåç</span> Set Region
                            </button>
                        </div>
                        <div class="module-result" id="regionResult"></div>
                    </div>

                    <div class="commands-grid" id="commandsGrid">
                        <!-- Commands will be dynamically loaded -->
                    </div>
                </div> <!-- commands-section -->
            </div> <!-- content-wrapper -->
        </main>
    </div> <!-- app-container -->

    <!-- Result Modal -->
    <div class="modal" id="resultModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Command Result</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="result-status" id="modalStatus">
                    <span class="status-badge">PASS</span>
                </div>
                <div class="result-command">
                    <label>Command:</label>
                    <code id="modalCommand"></code>
                </div>
                <div class="result-output">
                    <label>Output:</label>
                    <pre id="modalOutput"></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Clear Results Confirmation -->
    <div class="modal" id="confirmClearModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3 style="color: var(--error);">Clear All Results?</h3>
            </div>
            <div class="modal-body text-center">
                <p>This will reset all current test results. Are you sure?</p>
                <div class="modal-actions">
                    <button class="btn-modal btn-danger" id="btnConfirmClear">Yes, Clear All</button>
                    <button class="btn-modal btn-cancel" id="btnCancelClear">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Model Switch Modal -->
    <div class="modal" id="confirmSwitchModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Switch Model?</h3>
            </div>
            <div class="modal-body text-center">
                <p>Do you really want to switch from <strong id="oldModelName"></strong> to <strong
                        id="newModelName"></strong>?</p>
                <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 10px;">Unsaved results will
                    be lost.</p>
                <div class="modal-actions">
                    <button class="btn-modal btn-primary" id="btnConfirmSwitch">Switch Now</button>
                    <button class="btn-modal btn-cancel" id="btnCancelSwitch">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Manage Modal -->
    <div class="modal" id="manageModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Manage Test Cases</h3>
                <div id="adminStatus"
                    style="margin-left: auto; margin-right: 20px; font-size: 0.9rem; color: var(--text-secondary); display: none;">
                    Logged in as <span id="adminUserDisplayName"
                        style="color: var(--accent); font-weight: bold;"></span>
                    <button class="btn-link" id="btnLogout"
                        style="color: var(--error); margin-left: 10px; cursor: pointer; background: none; border: none; font-size: 0.9rem; text-decoration: underline;">Logout</button>
                </div>
                <button class="modal-close" id="manageModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="tabs" style="margin-bottom: 20px;">
                    <button class="tab-btn active" data-target="formAddCommand">Add Command</button>
                    <button class="tab-btn" data-target="formAddCategory">Add Module</button>
                    <button class="tab-btn" data-target="formAddModel">Add Model</button>
                    <button class="tab-btn" data-target="formEditItems">Edit Items</button>
                    <button class="tab-btn" data-target="formRemoveItems">Remove Items</button>
                </div>

                <!-- Add Command Form -->
                <!-- ... existing content ... -->
                <div id="formAddCommand" class="manage-form active">
                    <div class="form-group">
                        <label>Target Model</label>
                        <select id="addCmdModel" class="form-control"></select>
                    </div>
                    <div class="form-group">
                        <label>Command Name</label>
                        <input type="text" id="addCmdName" class="form-control" placeholder="e.g. Receive SMS">
                    </div>
                    <div class="form-group">
                        <label>SLDD Command</label>
                        <input type="text" id="addCmdValue" class="form-control" placeholder="adb1 shell sldd ...">
                    </div>
                    <div class="form-group">
                        <label>Target Module (Category)</label>
                        <select id="addCmdCategory" class="form-control">
                            <option value="sim">SIM</option>
                            <option value="network">Network</option>
                            <option value="call">Call</option>
                            <option value="sms">SMS</option>
                            <option value="ecall">eCall</option>
                            <option value="data">Data</option>
                            <option value="region">Region</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-top: 15px;">
                        <label>Expected Output (Matches whole output or partial regex)</label>
                        <input type="text" id="addCmdExpected" class="form-control"
                            placeholder="e.g. READY or ^NAD Region : IN$">
                    </div>
                    <div class="form-group" style="margin-top: 15px; display: flex; align-items: center; gap: 10px;">
                        <input type="checkbox" id="addCmdExclude" style="width: 20px; height: 20px;">
                        <label for="addCmdExclude" style="margin: 0;">Exclude from "Run All" (Verification Only)</label>
                    </div>
                    <button class="btn-primary w-100" id="btnSaveCommand" style="margin-top: 20px;">Add
                        Command</button>
                </div>

                <!-- Add Category/Module Form -->
                <div id="formAddCategory" class="manage-form">
                    <div class="form-group">
                        <label>Target Model</label>
                        <select id="addCatModel" class="form-control"></select>
                    </div>
                    <div class="form-group">
                        <label>Module ID (lowercase, no spaces, e.g. "diag_check")</label>
                        <input type="text" id="newCatId" class="form-control" placeholder="new_module">
                    </div>
                    <div class="form-group">
                        <label>Display Label (e.g. "Diagnostic Check")</label>
                        <input type="text" id="newCatLabel" class="form-control" placeholder="New Module">
                    </div>
                    <div class="form-group">
                        <label>Color (Hex)</label>
                        <input type="color" id="newCatColor" class="form-control" value="#6366f1" style="height: 40px;">
                    </div>
                    <button class="btn-primary w-100" id="btnSaveCategory" style="margin-top: 20px;">Add Module to
                        Model</button>
                </div>

                <!-- Add Model Form -->
                <div id="formAddModel" class="manage-form">
                    <div class="form-group">
                        <label>Model Name</label>
                        <input type="text" id="newModelNameInput" class="form-control" placeholder="e.g. Lexus 2026">
                    </div>
                    <div class="form-group">
                        <label>Model ID (Cannot be changed later easily)</label>
                        <input type="text" id="newModelIdInput" class="form-control" placeholder="lexus_2026">
                    </div>
                    <button class="btn-primary w-100" id="btnSaveModel" style="margin-top: 20px;">Create
                        Model</button>
                </div>

                <!-- Edit Items Form -->
                <div id="formEditItems" class="manage-form">
                    <div class="edit-section">
                        <h4>Edit Model Name</h4>
                        <div class="form-group">
                            <label>Select Model</label>
                            <select id="editModelSelect" class="form-control"></select>
                        </div>
                        <div class="form-group">
                            <label>New Model Name</label>
                            <input type="text" id="editModelNameInput" class="form-control">
                        </div>
                        <button class="btn-primary w-100" id="btnUpdateModel">Update Model Name</button>
                    </div>
                    <hr style="margin: 30px 0; border: none; border-top: 1px solid var(--border-color);">
                    <div class="edit-section">
                        <h4>Edit Command</h4>
                        <div class="form-group">
                            <label>Select Model</label>
                            <select id="editCmdModelSelect" class="form-control"></select>
                        </div>
                        <div class="form-group">
                            <label>Select Command</label>
                            <select id="editCmdSelect" class="form-control"></select>
                        </div>
                        <div class="form-group">
                            <label>Command Name</label>
                            <input type="text" id="editCmdNameInput" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>SLDD Command</label>
                            <input type="text" id="editCmdValueInput" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Module (Category)</label>
                            <select id="editCmdCategory" class="form-control">
                                <option value="sim">SIM</option>
                                <option value="network">Network</option>
                                <option value="call">Call</option>
                                <option value="sms">SMS</option>
                                <option value="ecall">eCall</option>
                                <option value="data">Data</option>
                                <option value="region">Region</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin-top: 15px;">
                            <label>Expected Output (Matches whole output or partial regex)</label>
                            <input type="text" id="editCmdExpectedInput" class="form-control"
                                placeholder="e.g. READY or ^NAD Region : IN$">
                        </div>
                        <div class="form-group"
                            style="margin-top: 15px; display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox" id="editCmdExclude" style="width: 20px; height: 20px;">
                            <label for="editCmdExclude" style="margin: 0;">Exclude from "Run All" (Verification
                                Only)</label>
                        </div>
                        <button class="btn-primary w-100" id="btnUpdateCommand">Update Command</button>
                    </div>
                </div>

                <!-- Remove Items Form -->
                <div id="formRemoveItems" class="manage-form">
                    <div class="remove-section">
                        <h4>Remove Models</h4>
                        <div id="removeModelList" class="remove-list">
                            <!-- Populated via JS -->
                        </div>
                    </div>
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid var(--border-color);">
                    <div class="remove-section">
                        <h4>Remove Commands</h4>
                        <div class="form-group">
                            <label>Select Model</label>
                            <select id="removeCmdModelSelect" class="form-control"></select>
                        </div>
                        <div id="removeCommandList" class="remove-list">
                            <!-- Populated via JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Modal -->
    <div class="modal" id="reportModal">
        <div class="modal-content report-modal-content">
            <div class="modal-header">
                <h3>Sanity Test Report</h3>
                <div class="modal-header-actions">
                    <button class="btn-primary" onclick="window.print()">üñ®Ô∏è Print</button>
                    <button class="modal-close" id="reportModalClose">&times;</button>
                </div>
            </div>
            <div class="modal-body">
                <div id="reportContainer" class="printable-report">
                    <div class="report-header-info text-center"
                        style="margin-bottom: 30px; padding: 20px; background: rgba(255,255,255,0.03); border-radius: 12px;">
                        <h1 id="reportModelName"
                            style="color: var(--text-primary) !important; font-size: 2.8rem; text-transform: uppercase; margin-bottom: 5px; text-shadow: 0 0 20px rgba(99,102,241,0.3);">
                            MODEL NAME
                        </h1>
                        <p style="color: var(--text-secondary); font-size: 1.1rem;">Generated on: <span id="reportDate"
                                style="color: var(--accent-primary);"></span></p>
                        <div id="reportControlsContainer" style="margin-top: 15px;"></div>
                    </div>

                    <!-- Export Options (Non-printable) -->
                    <div class="export-options no-print"
                        style="margin-bottom: 20px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px; border: 1px solid var(--border-color);">
                        <h4 style="margin-bottom: 10px; font-size: 0.9rem; color: var(--accent-primary);">Excel
                            Export Columns</h4>
                        <div style="display: flex; flex-wrap: wrap; gap: 15px;">
                            <label
                                style="display: flex; align-items: center; gap: 5px; font-size: 0.8rem; cursor: pointer;">
                                <input type="checkbox" checked data-col="sno"> S.No
                            </label>
                            <label
                                style="display: flex; align-items: center; gap: 5px; font-size: 0.8rem; cursor: pointer;">
                                <input type="checkbox" checked data-col="feature"> Feature
                            </label>
                            <label
                                style="display: flex; align-items: center; gap: 5px; font-size: 0.8rem; cursor: pointer;">
                                <input type="checkbox" checked data-col="actions"> Actions
                            </label>
                            <label
                                style="display: flex; align-items: center; gap: 5px; font-size: 0.8rem; cursor: pointer;">
                                <input type="checkbox" checked data-col="commands"> Commands
                            </label>
                            <label
                                style="display: flex; align-items: center; gap: 5px; font-size: 0.8rem; cursor: pointer;">
                                <input type="checkbox" checked data-col="output"> Actual Output
                            </label>
                            <label
                                style="display: flex; align-items: center; gap: 5px; font-size: 0.8rem; cursor: pointer; display: none;">
                                <input type="checkbox" data-col="expected"> Expected Output
                            </label>
                            <label
                                style="display: flex; align-items: center; gap: 5px; font-size: 0.8rem; cursor: pointer;">
                                <input type="checkbox" checked data-col="result"> Result
                            </label>
                        </div>
                    </div>

                    <div id="reportTableData"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3>Admin Login</h3>
                <button class="modal-close" id="loginModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="adminUsername" class="form-control" placeholder="e.g. nitish10.kumar">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="adminPassword" class="form-control" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button class="btn-primary w-100" id="btnLoginSubmit" style="margin-top: 10px;">Login</button>
            </div>
        </div>
    </div>

    <!-- DLT Settings Modal -->
    <div class="modal" id="dltConfigModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>‚öôÔ∏è DLT Viewer Settings</h3>
                <button class="modal-close" id="dltConfigModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 20px;">
                    Configure your local DLT tool path and port. These settings are saved in your browser.
                </p>

                <div class="form-group">
                    <label>YOUR DLT TCP PORT</label>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="color: var(--text-muted); font-size: 0.85rem;">tcp:</span>
                        <input type="number" id="dltPortInput" class="form-control" placeholder="3490"
                            style="width: 120px;">
                        <span style="color: var(--text-muted); font-size: 0.85rem;">‚Üí bridge</span>
                    </div>
                    <small style="color: var(--text-muted); font-size: 0.65rem; display: block; margin-top: 5px;">
                        Pick a unique port (e.g. 3490, 3491) if multiple users are on the same server.
                    </small>
                </div>

                <!-- New Connection Guide for Remote Users -->
                <div
                    style="margin-top: 20px; background: rgba(76, 175, 80, 0.1); border: 1px dashed rgba(76, 175, 80, 0.3); padding: 15px; border-radius: 6px;">
                    <p style="color: #4CAF50; font-size: 0.8rem; font-weight: bold; margin: 0 0 10px 0;">üîó HOW TO
                        CONNECT FROM YOUR LAPTOP:</p>
                    <ol
                        style="color: var(--text-muted); font-size: 0.75rem; padding-left: 20px; margin: 0; line-height: 1.6;">
                        <li>Open <b>DLT Viewer</b> on your own laptop.</li>
                        <li>Click <b>Config</b> ‚Üí <b>ECU Software</b>.</li>
                        <li>Add a new ECU or modify existing one:
                            <div
                                style="background: rgba(0,0,0,0.3); padding: 8px; margin: 5px 0; border-radius: 4px; font-family: monospace;">
                                IP: <span id="remoteGuideIp" style="color: white; font-weight: bold;">0.0.0.0</span><br>
                                Port: <span id="remoteGuidePort" style="color: white; font-weight: bold;">3490</span>
                                (Type: TCP)
                            </div>
                        </li>
                    </ol>
                </div>

                <div style="margin-top: 25px; padding-top: 15px; border-top: 1px solid var(--border-color);">
                    <button class="btn-primary w-100" id="btnSaveDltConfig">Save Changes & Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Regression Modal -->
    <div class="modal" id="regressionModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Regression Test Setup</h3>
                <button class="modal-close" id="regressionModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-row" style="display: flex; gap: 15px; margin-bottom: 20px; align-items: flex-end;">
                    <div class="form-group" style="flex: 1;">
                        <label>Total Iterations</label>
                        <input type="number" id="regIterations" class="form-control" value="10" min="1" max="500">
                    </div>
                </div>

                <div class="form-group" style="margin-bottom: 25px;">
                    <label style="display: flex; justify-content: space-between; align-items: center;">
                        <span>Test Sequence (Commands will run in order per iteration)</span>
                        <div style="display: flex; gap: 5px;">
                            <button id="btnAddRegModule" class="btn-secondary"
                                style="font-size: 0.75rem; padding: 4px 10px; background: rgba(255, 255, 255, 0.1);">üìö
                                Add Module Group</button>
                            <button id="btnAddRegStep" class="btn-secondary"
                                style="font-size: 0.75rem; padding: 4px 10px;">‚ûï Add Step</button>
                        </div>
                    </label>
                    <div id="regStepContainer"
                        style="display: flex; flex-direction: column; gap: 10px; margin-top: 10px; max-height: 200px; overflow-y: auto; padding-right: 5px;">
                        <!-- Step rows will be added here -->
                    </div>
                </div>

                <div class="regression-actions" style="margin-bottom: 20px; display: flex; gap: 10px;">
                    <button id="btnStartRegression" class="btn-primary" style="flex: 1;">üöÄ Start Regression</button>
                    <button id="btnPauseRegression" class="btn-warning" style="flex: 1; display: none;">‚è∏Ô∏è
                        Pause</button>
                    <button id="btnStopRegression" class="btn-danger" style="flex: 1; display: none;">üõë Stop</button>
                </div>

                <!-- Live Detailed Status -->
                <div id="regLiveStatus"
                    style="display: none; margin-bottom: 20px; padding: 20px; background: rgba(99, 102, 241, 0.05); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; position: relative; overflow: hidden;">
                    <div
                        style="position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: var(--accent-primary);">
                    </div>
                    <h4
                        style="font-size: 0.8rem; color: var(--accent-primary); margin-bottom: 15px; text-transform: uppercase; letter-spacing: 2px; font-weight: 700;">
                        üì° Live Status Tracker
                    </h4>
                    <div id="regStatusContent">
                        <!-- Dynamic content for Call/SMS/Etc -->
                        <div style="color: var(--text-muted); text-align: center; font-style: italic;">Initializing
                            tracker...</div>
                    </div>
                </div>

                <div id="regProgress" class="regression-progress" style="display: none;">
                    <div class="progress-stats"
                        style="display: flex; justify-content: space-between; margin-bottom: 10px; font-weight: 600;">
                        <span>Total: <span id="regTotalCount">0</span></span>
                        <span style="color: var(--success);">Pass: <span id="regPassCount">0</span></span>
                        <span style="color: var(--error);">Fail: <span id="regFailCount">0</span></span>
                        <span>Current: <span id="regCurrentIdx">0</span></span>
                    </div>
                    <div class="progress-bar-bg"
                        style="height: 10px; background: rgba(255,255,255,0.1); border-radius: 5px; overflow: hidden; margin-bottom: 20px;">
                        <div id="regProgressBar"
                            style="height: 100%; width: 0%; background: var(--accent-gradient); transition: width 0.3s ease;">
                        </div>
                    </div>
                </div>

                <div class="regression-log" id="regressionLog"
                    style="max-height: 300px; overflow-y: auto; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 15px; font-family: monospace; font-size: 0.85rem;">
                    <div style="color: var(--text-muted); text-align: center;">Waiting to start...</div>
                </div>
                <div style="margin-top: 10px; display: flex; justify-content: flex-end; gap: 10px;">
                    <button class="btn-secondary" id="btnClearRegLog">üóëÔ∏è Clear Log</button>
                    <button class="btn-primary" id="btnExportRegReport">üì• Export Report</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <!-- Module Selection Modal -->
    <div id="moduleSelectionModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>Select Modules to Run</h3>
                <button class="modal-close" id="moduleSelectModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 15px; color: var(--text-secondary);">Choose which functional modules to include
                    in this test run. Only commands not marked as "Verification Only" will be executed.</p>
                <div id="moduleChecklist"
                    style="display: flex; flex-direction: column; gap: 10px; max-height: 400px; overflow-y: auto; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 8px;">
                    <!-- Categories will be injected here -->
                </div>
                <div class="form-group" style="margin-top: 20px; display: flex; align-items: center; gap: 10px;">
                    <input type="checkbox" id="includeVerificationCmds" style="width: 18px; height: 18px;">
                    <label for="includeVerificationCmds" style="margin: 0; font-size: 0.9rem;">Include "Verification
                        Only" commands</label>
                </div>
                <div style="margin-top: 25px; display: flex; gap: 10px;">
                    <button class="btn-secondary w-100" id="btnSelectAllModules">Select All</button>
                    <button class="btn-primary w-100" id="btnStartCustomRun">‚ñ∂Ô∏è Start Run</button>
                </div>
            </div>
        </div>
    </div>

</body>

</html>